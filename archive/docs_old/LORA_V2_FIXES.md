# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è LoRA V2 "Background removal failed"

## üìÖ –î–∞—Ç–∞: 8 —è–Ω–≤–∞—Ä—è 2025

## üéØ –ü—Ä–æ–±–ª–µ–º–∞
LoRA V2 –≤–æ–∑–≤—Ä–∞—â–∞–ª –æ—à–∏–±–∫—É **"Background removal failed"** –∏–∑-–∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ API.

## üîç –ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞

### ‚ùå **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥–∞ JSON**
–ö–æ–Ω—Ñ–∏–≥ —Å–æ–¥–µ—Ä–∂–∞–ª –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è **–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏**, –∞ –Ω–µ –¥–ª—è **inference**:
```json
{
  "steps": 1000,              // –î–ª—è –æ–±—É—á–µ–Ω–∏—è, –ù–ï –¥–ª—è inference
  "learning_rate": 0.0001,    // –î–ª—è –æ–±—É—á–µ–Ω–∏—è, –ù–ï guidance_scale
  "default_caption": "..."
}
```

### ‚ùå **API –æ—à–∏–±–∫–∞**
```
'num_inference_steps'], 'msg': 'ensure this value is less than or equal to 50'
```
FLUX Kontext API –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –º–∞–∫—Å–∏–º—É–º **50 —à–∞–≥–æ–≤**, –∞ –Ω–µ 1000.

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### üìÅ **src/processors/batch_processor.py**

#### –î–æ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
```python
if lora_version == 'v2':
    inference_steps = 1000      # ‚ùå –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ
    guidance_scale = 0.0001     # ‚ùå –°–ª–∏—à–∫–æ–º –º–∞–ª–æ
```

#### –ü–æ—Å–ª–µ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
```python
if lora_version == 'v2':
    inference_steps = 50        # ‚úÖ –ú–∞–∫—Å–∏–º—É–º –¥–ª—è API
    guidance_scale = 3.5        # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### ‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**
```bash
üîß LoRA V2 –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
   –ü—É—Ç—å: https://v3.fal.media/files/zebra/KoeQj8N4bU6OGnPT2VABy_adapter_model.safetensors
   –®–∞–≥–∏: 50 (–º–∞–∫—Å –¥–ª—è inference)
   Guidance Scale: 3.5
   –ü—Ä–æ–º–ø—Ç: remove background, clean product image...

‚úÖ –£—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Å LoRA v2
–†–µ–∑—É–ª—å—Ç–∞—Ç V2: <class 'PIL.PngImagePlugin.PngImageFile'>
```

## üìã –ö–ª—é—á–µ–≤—ã–µ —Ä–∞–∑–ª–∏—á–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–±—É—á–µ–Ω–∏–µ (JSON) | Inference (API) | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ |
|----------|----------------|-----------------|-------------|
| steps | 1000 | ‚â§ 50 | 1000 ‚Üí 50 |
| learning_rate | 0.0001 | N/A | –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |
| guidance_scale | N/A | 2.5-7.0 | 0.0001 ‚Üí 3.5 |

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω—ã –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ API
2. **–û—Ç–ª–∞–¥–∫–∞ –æ—à–∏–±–æ–∫**: –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –≤—ã–≤–æ–¥ –æ—à–∏–±–æ–∫ API
3. **–í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–µ—Ä–µ–¥ –∑–∞–ø—Ä–æ—Å–æ–º

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–î–æ**: ‚ùå LoRA V2 –≤—Å–µ–≥–¥–∞ –ø–∞–¥–∞–ª —Å API –æ—à–∏–±–∫–æ–π  
**–ü–æ—Å–ª–µ**: ‚úÖ LoRA V2 —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ  
**–ê–≤—Ç–æ—Ä**: AI Assistant (Claude)  
**–î–∞—Ç–∞**: 8 —è–Ω–≤–∞—Ä—è 2025